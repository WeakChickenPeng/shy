# Shy


## 1. 概要

### 1.1 简介

她是一个娇小、却能顶半边天的框架。

### 1.2 特性列表

1. 容器
2. 流水线
3. 门面
4. 路由
5. 控制器
6. 中间件
7. 请求
8. 响应
9. 模版
10. 异常处理
11. 命令模式

### 1.3 用法

##### 第一步

```bash
git clone https://github.com/lynncho/shy.git
```

##### 第二步

```bash
composer install
```

### 2. 核心

#### 2.1 容器

几乎所有实例都在容器里面，包括框架核心类。你可以对实例随意绑定、加入、取出、替换或清除。

**注意：本框架提供了十分开放的容器、提升了开发可能性。但是，开发者在操作核心类的时候，一定要仔细梳理运行流程，以免产生bug。**

##### 2.1.1 绑定实例

###### 2.1.1.1 用法模式

bind(抽象名称, 实例或闭包)

###### 2.1.1.2 代码示例

```php

/**
 * 绑定实例
 * 
 * 返回 容器实例
 */
bind('web', new shy\web());

/**
 * 绑定实例、加入到容器、执行实例方法（链式调用）
 */
bind('web', new shy\web())->shy('web')->run();

/**
 * 绑定闭包（可用于延迟传参，支持0到N任意参数数量）
 * 
 * 返回 容器实例
 */
bind('web', function ($param1, $param2) {
    return new shy\web($param1, $param2);
});
```

bind函数只是绑定实例或闭包，并没有将实例加入到容器，所以也无法从容器中获取绑定的实例。

bind函数返回容器实例以便链式调用。

##### 2.1.2 加入、取出实例

###### 2.1.2.1 用法模式

1. shy(抽象名称, 0-N个参数)
2. shy(抽象名称, 实例或闭包, 0-N个参数)
3. shy(命名空间类名, 0-N个参数)
4. shy(抽象名称, 命名空间类名, 0-N个参数)

###### 2.1.2.2 代码示例

```php
/**
 * 运行绑定的闭包，将实例加入容器
 * shy函数，如果名称被占用，只返回已存在的实例
 * 
 * 返回 web实例
 */
shy('web');

/**
 * 带参运行绑定的闭包，将实例加入容器
 * 
 * 返回 web实例
 */
shy('web', $parma1, $param2);

/**
 * 带参直接运行闭包，将实例加入容器
 * 
 * 返回 web实例
 */
shy('web', function ($param1, $param2) {
    return new shy\web($param1, $param2);
}, $param1, $param2);

/**
 * 命名空间作为抽象名称，实例化带命名空间的类，将实例加入容器
 *
 * 返回 web实例
 */
shy('shy\web');

/**
 * 实例化带命名空间的类并设置别名，将实例加入容器
 * 
 * 返回 web实例
 */
shy('web','shy\web');
```

shy函数是框架的核心函数之一，可以运行闭包实例化对象、将实例加入容器。函数的返回值为加入的实例。

该函数在抽象名称被占用时，会直接返回已存在的抽象名称的对应实例。你可以通过`shy_list()`函数获取容器内的所有抽象名称，或者使用`in_shy_list()`函数判断是不是已存在。

实例加入容器之后，会清除绑定以免占用内存。

##### 2.1.3 替换实例

```php
/**
 * 如果名称被占用，替换成新实例
 * 
 * 返回 web实例
 */
makeNew('web', new shy\web());

/**
 * 如果名称被占用，替换成新实例
 * 
 * 返回 web实例
 */
makeNew('web', new shy\web());
```

##### 2.1.3 清除实例

```php
/**
 * 清除抽象名称为web的绑定和实例
 */
shy_clear('web');

/**
 * 清除所有绑定和实例
 */
shy_clear_all();
```